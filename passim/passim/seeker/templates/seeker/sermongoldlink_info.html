{% load i18n %}

<!-- Sermon information -->
<form style="width: 100%;">
    {% csrf_token %}
    <table class="func-view">
      <tbody>
        <!-- Row with edit and delete buttons -->
        <tr>
          <td colspan="2"  class="ms editable table">
            <!-- Provide the necessary buttons: edit, cancel and save -->
            {% if is_passim_editor %}
            <a mode="edit" class="view-mode btn btn-xs jumbo-1">
              <span class="glyphicon glyphicon-pencil" title="Edit this gold-sermon link"></span>
            </a>
            {% endif %}

            <a mode="cancel" class="edit-mode btn btn-xs jumbo-2 hidden">
              <span class="glyphicon glyphicon-arrow-left" title="Cancel (do *NOT* save this link)"></span>
            </a>

            {% if is_passim_editor %}
            <a mode="save" class="edit-mode btn btn-xs jumbo-1 hidden" targetid=""
               targeturl="{% if glinkForm.instance.id %}{% url 'goldlink_view' glinkForm.instance.id %}{% else %}{% url 'goldlink_view' %}{% endif %}" >
              <span class="glyphicon glyphicon-ok" title="Save these data">&nbsp;Save</span>
            </a>
            {% endif %}

            <!-- Waiting symbol-->
            <span class="waiting glyphicon glyphicon-refresh glyphicon-refresh-animate hidden"></span>

            <!-- Little error message room -->
            <span id="gold_err_msg" class="err-msg"></span>

            {% if is_passim_editor %}
            <!-- Put the delete button completely to the right-->
            <a mode="delete" class="edit-mode btn btn-xs jumbo-3 pull-right hidden" targetid="sermon_edit"
               targeturl="{% if glinkForm.instance.id %}{% url 'goldlink_view' glinkForm.instance.id %}{% endif %}">
              <span class="glyphicon glyphicon-remove" title="Delete this sermon"></span>
            </a>
            {% endif %}
          </td>
        </tr>

        <!-- Room for the standard fields -->
        <tr>
          <!-- Pro Forma: first element is the source -->
          <td class="hidden">SOURCE</td>
          <!-- Next come the features of the link -->
          <td class="hoverable" style="min-width: 100px;"><b>Link type</b></td>
          <td class="hoverable" style="width: 100%;"><b>Towards</b></td>
        </tr>
        <tr>
          <td class="hidden"><input id="id_glink-src" name="glink-src" value="{{glinkForm.src.value}}" /></td>
          <td style="min-width: 100px;">
            <div class="edit-mode hidden">{{glinkForm.linktype}}</div>
            <div class="view-mode">{{glinkForm.instance.get_linktype_display}}</div>
          </td>
          <td id="sermongoldlink_{{glinkForm.src.value}}" style="width: 100%">
            <div class="hidden"><input id="id_glink-dst" name="glink-dst" value="{{glinkForm.instance.dst.id}}" /></div>
            <div class="view-mode" 
                 targetid="sermongold_select_{{glinkForm.src.value}}"
                 targeturl="{% if glinkForm.instance.src %}{% url 'select_gold' glinkForm.instance.src.id %}{% else %}{% url 'select_gold' %}{% endif %}">
              {% include 'seeker/sermongold_view.html' with msitem=glinkForm.instance.dst %}
            </div>
            <div class="edit-mode hidden selected" 
                 targetid="sermongold_select_{{glinkForm.src.value}}">
              {% include 'seeker/sermongold_view.html' with msitem=glinkForm.instance.dst %}
            </div>
          </td>
        </tr>
      </tbody>
    </table>
</form>

<!-- Searching for a gold sermon-->
<div id="sermongold_select_{{glinkForm.src.value}}" 
     class="edit-mode hidden subform"
     towardsid="sermongoldlink_{{glinkForm.src.value}}" >
  {% include 'seeker/sermongold_select.html' with source_id=glinkForm.src.value %}
</div>
